<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - TechHub Computer Components Store</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
  </head>
  <body class="bg-light pt-5">
    <!-- Header will be loaded dynamically from components/header.html -->
    <header id="header-container"></header>

    <main class="py-5">
      <div class="container py-4">
        <div class="row justify-content-center">
          <div class="col-md-8 col-lg-5">
            <!-- Login Form -->
            <div
              class="bg-white rounded-4 shadow-sm p-4 p-md-5 mb-4"
              id="login-container"
            >
              <div class="text-center mb-4">
                <div
                  class="d-inline-flex align-items-center justify-content-center bg-primary bg-opacity-10 rounded-circle mb-3"
                  style="width: 80px; height: 80px"
                >
                  <i class="bi bi-person-lock fs-1 text-primary"></i>
                </div>
                <h2 class="fw-bold mb-2">Login</h2>
                <p class="text-muted">Sign in to access your account</p>
              </div>

              <form id="login-form">
                <div class="mb-3">
                  <label for="login-email" class="form-label fw-medium"
                    >Email Address</label
                  >
                  <div class="input-group">
                    <span class="input-group-text bg-light"
                      ><i class="bi bi-envelope"></i
                    ></span>
                    <input
                      type="email"
                      class="form-control"
                      id="login-email"
                      name="email"
                      placeholder="you@example.com"
                      required
                    />
                  </div>
                </div>
                <div class="mb-3">
                  <label for="login-password" class="form-label fw-medium"
                    >Password</label
                  >
                  <div class="input-group">
                    <span class="input-group-text bg-light"
                      ><i class="bi bi-key"></i
                    ></span>
                    <input
                      type="password"
                      class="form-control"
                      id="login-password"
                      name="password"
                      required
                    />
                  </div>
                </div>
                <div class="mb-3 form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    id="remember-me"
                  />
                  <label class="form-check-label" for="remember-me"
                    >Remember me</label
                  >
                </div>
                <div class="d-grid mb-3">
                  <button type="submit" class="btn btn-primary btn-lg">
                    <i class="bi bi-box-arrow-in-right me-2"></i>Login
                  </button>
                </div>
                <div class="text-center mb-3">
                  <a
                    href="#"
                    id="forgot-password-link"
                    class="text-decoration-none"
                  >
                    <i class="bi bi-question-circle me-1"></i>Forgot Password?
                  </a>
                </div>
              </form>

              <!-- Divider -->
              <div class="position-relative my-4">
                <hr />
                <p
                  class="small text-muted position-absolute top-50 start-50 translate-middle bg-white px-2"
                >
                  OR CONTINUE WITH
                </p>
              </div>

              <!-- Social Login -->
              <div class="row g-3">
                <div class="col-6">
                  <button
                    id="google-login"
                    class="btn btn-danger d-flex align-items-center justify-content-center gap-2 w-100"
                  >
                    <i class="bi bi-google"></i> Google
                  </button>
                </div>
                <div class="col-6">
                  <button
                    id="facebook-login"
                    class="btn btn-primary d-flex align-items-center justify-content-center gap-2 w-100"
                  >
                    <i class="bi bi-facebook"></i> Facebook
                  </button>
                </div>
              </div>

              <!-- Register Link -->
              <div class="text-center mt-4">
                <p class="mb-0">
                  Don't have an account?
                  <a
                    href="register.html"
                    class="text-decoration-none fw-semibold"
                  >
                    Register here
                  </a>
                </p>
              </div>
            </div>

            <!-- Forgot Password Form (hidden by default) -->
            <div
              class="bg-white rounded-4 shadow-sm p-4 p-md-5 mb-4 d-none"
              id="forgot-password-container"
            >
              <div class="text-center mb-4">
                <div
                  class="d-inline-flex align-items-center justify-content-center bg-warning bg-opacity-10 rounded-circle mb-3"
                  style="width: 80px; height: 80px"
                >
                  <i class="bi bi-envelope-exclamation fs-1 text-warning"></i>
                </div>
                <h2 class="fw-bold mb-2">Forgot Password</h2>
                <p class="text-muted">
                  Enter your email address and we'll send you a link to reset
                  your password.
                </p>
              </div>

              <form id="forgot-password-form">
                <div class="mb-4">
                  <label
                    for="forgot-password-email"
                    class="form-label fw-medium"
                    >Email Address</label
                  >
                  <div class="input-group">
                    <span class="input-group-text bg-light"
                      ><i class="bi bi-envelope"></i
                    ></span>
                    <input
                      type="email"
                      class="form-control"
                      id="forgot-password-email"
                      name="email"
                      placeholder="you@example.com"
                      required
                    />
                  </div>
                </div>
                <div class="d-grid mb-3">
                  <button type="submit" class="btn btn-primary btn-lg">
                    <i class="bi bi-send me-2"></i>Send Reset Link
                  </button>
                </div>
                <div class="text-center">
                  <a
                    href="#"
                    id="back-to-login-link"
                    class="text-decoration-none"
                  >
                    <i class="bi bi-arrow-left me-1"></i>Back to Login
                  </a>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer will be loaded dynamically from components/footer.html -->
    <footer id="footer-container"></footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SweetAlert2 for better alerts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.2/dist/sweetalert2.all.min.js"></script>

    <script>
      // Update this code in both login.html and register.html files
      document.addEventListener("DOMContentLoaded", function () {
        // Load header - Using the correct path for your project structure
        fetch("/client/src/components/header.html") // Adjust this path based on your project structure
          .then((response) => {
            if (!response.ok) {
              throw new Error(
                `Failed to load header: ${response.status} ${response.statusText}`
              );
            }
            return response.text();
          })
          .then((html) => {
            document.getElementById("header-container").innerHTML = html;

            // After loading header, highlight the current page in the navigation
            setTimeout(() => {
              // Get the current page filename
              const currentPage =
                window.location.pathname.split("/").pop() || "index.html";

              // Find all links to the current page and mark them as active
              const currentPageLinks = document.querySelectorAll(
                `a[href="${currentPage}"]`
              );
              currentPageLinks.forEach((link) => {
                if (link.classList.contains("dropdown-item")) {
                  link.classList.add("active");
                }

                // If parent is a dropdown, mark it as active too
                const dropdownToggle = link
                  .closest(".dropdown")
                  ?.querySelector(".dropdown-toggle");
                if (dropdownToggle) {
                  dropdownToggle.classList.add("active");
                }
              });
            }, 100);
          })
          .catch((error) => {
            console.error("Error loading header:", error);
            document.getElementById("header-container").innerHTML = `
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-heading">Error Loading Header</h4>
          <p>${error.message}</p>
          <hr>
          <p class="mb-0">Please check the path to your header component and ensure it's accessible.</p>
        </div>
      `;
          });

        // Load footer - Using the correct path for your project structure
        fetch("/client/src/components/footer.html") // Adjust this path based on your project structure
          .then((response) => {
            if (!response.ok) {
              throw new Error(
                `Failed to load footer: ${response.status} ${response.statusText}`
              );
            }
            return response.text();
          })
          .then((html) => {
            document.getElementById("footer-container").innerHTML = html;
          })
          .catch((error) => {
            console.error("Error loading footer:", error);
            document.getElementById("footer-container").innerHTML = `
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-heading">Error Loading Footer</h4>
          <p>${error.message}</p>
          <hr>
          <p class="mb-0">Please check the path to your footer component and ensure it's accessible.</p>
        </div>
      `;
          });
      });

      // Toggle between login and forgot password forms
      document
        .getElementById("forgot-password-link")
        .addEventListener("click", function (e) {
          e.preventDefault();
          document.getElementById("login-container").classList.add("d-none");
          document
            .getElementById("forgot-password-container")
            .classList.remove("d-none");
        });

      document
        .getElementById("back-to-login-link")
        .addEventListener("click", function (e) {
          e.preventDefault();
          document.getElementById("login-container").classList.remove("d-none");
          document
            .getElementById("forgot-password-container")
            .classList.add("d-none");
        });

      // Add loading state to login button on form submission
      document
        .getElementById("login-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const submitBtn = this.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;
          submitBtn.disabled = true;
          submitBtn.innerHTML =
            '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Logging in...';

          // Simulate login process (replace with actual API call in production)
          setTimeout(() => {
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;

            // Show success message
            Swal.fire({
              title: "Login Successful!",
              text: "Welcome back to TechHub",
              icon: "success",
              confirmButtonText: "Continue",
            }).then(() => {
              // Redirect to home page or dashboard after successful login
              window.location.href = "index.html";
            });
          }, 1500);
        });

      // Add loading state to forgot password button on form submission
      document
        .getElementById("forgot-password-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const submitBtn = this.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;
          submitBtn.disabled = true;
          submitBtn.innerHTML =
            '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Sending...';

          // Simulate password reset email (replace with actual API call in production)
          setTimeout(() => {
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalText;

            // Show success message
            Swal.fire({
              title: "Reset Link Sent!",
              text: "Password reset link has been sent to your email address.",
              icon: "success",
              confirmButtonText: "OK",
            }).then(() => {
              // Redirect back to login form
              document
                .getElementById("login-container")
                .classList.remove("d-none");
              document
                .getElementById("forgot-password-container")
                .classList.add("d-none");
            });
          }, 1500);
        });
    </script>
  </body>
</html>
